{"version":3,"file":"omis.esm.js","sources":["../src/obaa.js","../src/path.js","../src/react.js","../src/omis.js"],"sourcesContent":["\nexport function obaa(target, arr, callback) {\n\n  var eventPropArr = []\n  if (isArray(target)) {\n    if (target.length === 0) {\n      target.__o_ = {\n        __r_: target,\n        __p_: '#'\n      }\n    }\n    mock(target, target)\n  }\n  for (var prop in target) {\n    if (target.hasOwnProperty(prop)) {\n      if (callback) {\n        if (isArray(arr) && isInArray(arr, prop)) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        } else if (isString(arr) && prop === arr) {\n          eventPropArr.push(prop)\n          watch(target, prop, null, target)\n        }\n      } else {\n        eventPropArr.push(prop)\n        watch(target, prop, null, target)\n      }\n    }\n  }\n  if (!target.__c_) {\n    target.__c_ = []\n  }\n  var propChanged = callback ? callback : arr\n  target.__c_.push({\n    all: !callback,\n    propChanged: propChanged,\n    eventPropArr: eventPropArr\n  })\n}\n\nvar triggerStr = [\n  'concat',\n  'copyWithin',\n  'fill',\n  'pop',\n  'push',\n  'reverse',\n  'shift',\n  'sort',\n  'splice',\n  'unshift',\n  'size'\n].join(',')\n\nvar methods = [\n  'concat',\n  'copyWithin',\n  'entries',\n  'every',\n  'fill',\n  'filter',\n  'find',\n  'findIndex',\n  'forEach',\n  'includes',\n  'indexOf',\n  'join',\n  'keys',\n  'lastIndexOf',\n  'map',\n  'pop',\n  'push',\n  'reduce',\n  'reduceRight',\n  'reverse',\n  'shift',\n  'slice',\n  'some',\n  'sort',\n  'splice',\n  'toLocaleString',\n  'toString',\n  'unshift',\n  'values',\n  'size'\n]\n\nfunction mock(target, root) {\n  methods.forEach(function (item) {\n    target[item] = function () {\n      var old = Array.prototype.slice.call(this, 0)\n      var result = Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n      if (new RegExp('\\\\b' + item + '\\\\b').test(triggerStr)) {\n        for (var cprop in this) {\n          if (\n            this.hasOwnProperty(cprop) &&\n            !isFunction(this[cprop])\n          ) {\n            watch(this, cprop, this.__o_.__p_, root)\n          }\n        }\n        //todo\n        onPropertyChanged(\n          'Array-' + item,\n          this,\n          old,\n          this,\n          this.__o_.__p_,\n          root\n        )\n      }\n      return result\n    }\n    target[\n      'pure' + item.substring(0, 1).toUpperCase() + item.substring(1)\n    ] = function () {\n      return Array.prototype[item].apply(\n        this,\n        Array.prototype.slice.call(arguments)\n      )\n    }\n  })\n}\n\nfunction watch(target, prop, path, root) {\n  if (prop === '__o_') return\n  if (isFunction(target[prop])) return\n  if (!target.__o_) target.__o_ = {\n    __r_: root\n  }\n  if (path !== undefined && path !== null) {\n    target.__o_.__p_ = path\n  } else {\n    target.__o_.__p_ = '#'\n  }\n\n  var currentValue = (target.__o_[prop] = target[prop])\n  Object.defineProperty(target, prop, {\n    get: function () {\n      return this.__o_[prop]\n    },\n    set: function (value) {\n      var old = this.__o_[prop]\n      this.__o_[prop] = value\n      onPropertyChanged(\n        prop,\n        value,\n        old,\n        this,\n        target.__o_.__p_,\n        root\n      )\n    },\n    configurable: true,\n    enumerable: true\n  })\n  if (typeof currentValue === 'object') {\n    if (isArray(currentValue)) {\n      mock(currentValue, root)\n      if (currentValue.length === 0) {\n        if (!currentValue.__o_) currentValue.__o_ = {}\n        if (path !== undefined && path !== null) {\n          currentValue.__o_.__p_ = path + '-' + prop\n        } else {\n          currentValue.__o_.__p_ = '#-' + prop\n        }\n      }\n    }\n    for (var cprop in currentValue) {\n      if (currentValue.hasOwnProperty(cprop)) {\n        watch(\n          currentValue,\n          cprop,\n          target.__o_.__p_ + '-' + prop,\n          root\n        )\n      }\n    }\n  }\n}\n\n\nfunction onPropertyChanged(prop, value, oldValue, target, path, root) {\n  if (value !== oldValue && (!(nan(value) && nan(oldValue))) && root.__c_) {\n    var rootName = getRootName(prop, path)\n    for (\n      var i = 0, len = root.__c_.length; i < len; i++\n    ) {\n      var handler = root.__c_[i]\n      if (\n        handler.all ||\n        isInArray(handler.eventPropArr, rootName) ||\n        rootName.indexOf('Array-') === 0\n      ) {\n        handler.propChanged.call(target, prop, value, oldValue, path)\n      }\n    }\n  }\n\n  if (prop.indexOf('Array-') !== 0 && typeof value === 'object') {\n    watch(target, prop, target.__o_.__p_, root)\n  }\n}\n\nfunction isFunction(obj) {\n  return Object.prototype.toString.call(obj) === '[object Function]'\n}\n\nfunction nan(value) {\n  return typeof value === \"number\" && isNaN(value)\n}\n\nfunction isArray(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]'\n}\n\nfunction isString(obj) {\n  return typeof obj === 'string'\n}\n\nfunction isInArray(arr, item) {\n  for (var i = arr.length; --i > -1;) {\n    if (item === arr[i]) return true\n  }\n  return false\n}\n\n\nfunction getRootName(prop, path) {\n  if (path === '#') {\n    return prop\n  }\n  return path.split('-')[1]\n}\n\nobaa.add = function (obj, prop) {\n  watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n}\n\nobaa.set = function (obj, prop, value) {\n  watch(obj, prop, obj.__o_.__p_, obj.__o_.__r_)\n  obj[prop] = value\n}\n\n//@ts-ignore\n/* eslint-disable */\nArray.prototype.size = function (length) {\n  this.length = length\n}","\nconst OBJECTTYPE = '[object Object]'\nconst ARRAYTYPE = '[object Array]'\n\nexport function getUsing(data, paths) {\n  const obj = []\n  paths.forEach((path, index) => {\n    const isPath = typeof path === 'string'\n    if (isPath) {\n      obj[index] = getTargetByPath(data, path)\n    } else {\n      const key = Object.keys(path)[0]\n      const value = path[key]\n      if (typeof value === 'string') {\n        obj[index] = getTargetByPath(data, value)\n      } else {\n        const tempPath = value[0]\n        if (typeof tempPath === 'string') {\n          const tempVal = getTargetByPath(data, tempPath)\n          obj[index] = value[1] ? value[1](tempVal) : tempVal\n        } else {\n          const args = []\n          tempPath.forEach(path =>{\n            args.push(getTargetByPath(data, path))\n          })\n          obj[index] = value[1].apply(null, args)\n        }\n      }\n      obj[key] = obj[index]\n    }\n  })\n  return obj\n}\n\nexport function getTargetByPath(origin, path) {\n  const arr = path.replace(/]/g, '').replace(/\\[/g, '.').split('.')\n  let current = origin\n  for (let i = 0, len = arr.length; i < len; i++) {\n    current = current[arr[i]]\n  }\n  return current\n}\n\n\nexport function getPath(obj) {\n  if (Object.prototype.toString.call(obj) === '[object Array]') {\n    const result = {}\n    obj.forEach(item => {\n      if (typeof item === 'string') {\n        result[item] = true\n      } else {\n        const tempPath = item[Object.keys(item)[0]]\n        if (typeof tempPath === 'string') {\n          result[tempPath] = true\n        } else {\n          if(typeof tempPath[0] === 'string'){\n            result[tempPath[0]] = true\n          }else{\n            tempPath[0].forEach(path => result[path] = true)\n          }\n        }\n      }\n    })\n    return result\n  } else {\n    return getUpdatePath(obj)\n  }\n}\n\nexport function getUpdatePath(data) {\n  const result = {}\n  dataToPath(data, result)\n  return result\n}\n\nfunction dataToPath(data, result) {\n  Object.keys(data).forEach(key => {\n    result[key] = true\n    const type = Object.prototype.toString.call(data[key])\n    if (type === OBJECTTYPE) {\n      _objToPath(data[key], key, result)\n    } else if (type === ARRAYTYPE) {\n      _arrayToPath(data[key], key, result)\n    }\n  })\n}\n\nfunction _objToPath(data, path, result) {\n  Object.keys(data).forEach(key => {\n    result[path + '.' + key] = true\n    delete result[path]\n    const type = Object.prototype.toString.call(data[key])\n    if (type === OBJECTTYPE) {\n      _objToPath(data[key], path + '.' + key, result)\n    } else if (type === ARRAYTYPE) {\n      _arrayToPath(data[key], path + '.' + key, result)\n    }\n  })\n}\n\nfunction _arrayToPath(data, path, result) {\n  data.forEach((item, index) => {\n    result[path + '[' + index + ']'] = true\n    delete result[path]\n    const type = Object.prototype.toString.call(item)\n    if (type === OBJECTTYPE) {\n      _objToPath(item, path + '[' + index + ']', result)\n    } else if (type === ARRAYTYPE) {\n      _arrayToPath(item, path + '[' + index + ']', result)\n    }\n  })\n}\n\n\nexport function needUpdate(diffResult, updatePath) {\n  for (let keyA in diffResult) {\n    if (updatePath[keyA]) {\n      return true\n    }\n    for (let keyB in updatePath) {\n      if (includePath(keyA, keyB)) {\n        return true\n      }\n    }\n  }\n  return false\n}\n\nfunction includePath(pathA, pathB) {\n  if (pathA.indexOf(pathB) === 0) {\n    const next = pathA.substr(pathB.length, 1)\n    if (next === '[' || next === '.') {\n      return true\n    }\n  }\n  return false\n}\n\nexport function fixPath(path) {\n  let mpPath = ''\n  const arr = path.replace('#-', '').split('-')\n  arr.forEach((item, index) => {\n    if (index) {\n      if (isNaN(Number(item))) {\n        mpPath += '.' + item\n      } else {\n        mpPath += '[' + item + ']'\n      }\n    } else {\n      mpPath += item\n    }\n  })\n  return mpPath\n}\n","import React from 'react'\nimport {obaa} from './obaa'\nimport {\n  getPath,\n  needUpdate,\n  fixPath\n} from './path'\n\nconst components = []\nconst updateSelfComponents = []\n\nlet isSelf = false\nlet currentComponent = null\n\nexport function $r(options) {\n  if (options.store) {\n    omis.store = options.store\n    obaa(omis.store.data, (prop, val, old, path) => {\n      const patch = {}\n\n      patch[fixPath(path + '-' + prop)] = true\n      components.forEach(component => {\n        if (component.__$updatePath_ && needUpdate(patch, component.__$updatePath_)) {\n          component.setState({ __$id_: component.state.__$id_++ });\n\n          isSelf = false\n        }\n      })\n\n      updateSelfComponents.forEach(component => {\n        if (component.__$updateSelfPath_ && needUpdate(patch, component.__$updateSelfPath_)) {\n          component.setState({ __$id_: component.state.__$id_++ });\n          isSelf = true\n          currentComponent = component\n        }\n      })\n    })\n  }\n\n  const updatePath = options.use && getPath(options.use)\n  const updateSelfPath = options.useSelf && getPath(options.useSelf)\n\n  return class extends React.Component {\n\n    state = {\n      __$id_: 0\n    }\n\n    constructor(props) {\n      super(props)\n      if (updatePath) {\n        components.push(this)\n        this.__$updatePath_ = updatePath\n      }\n      if (updateSelfPath) {\n        updateSelfComponents.push(this)\n        this.__$updateSelfPath_ = updateSelfPath\n      }\n    }\n\n    shouldComponentUpdate() {\n      if (currentComponent === this) return true\n      return !isSelf\n    }\n\n    render() {\n      return options.render.apply(this, arguments)\n    }\n  }\n}","\nimport {$r} from './react'\n\nconst root = getGlobal()\n\nconst omis = {\n  $r\n}\n\nroot.Omis = omis\nroot.omis = omis\nroot.Omis.version = '2.0.0'\n\nexport default omis\n\nexport {\n  $r\n}\n\n\nfunction getGlobal() {\n  if (\n    typeof global !== 'object' ||\n    !global ||\n    global.Math !== Math ||\n    global.Array !== Array\n  ) {\n    return (\n      self ||\n      window ||\n      global ||\n      (function() {\n        return this\n      })()\n    )\n  }\n  return global\n}"],"names":["obaa","target","arr","callback","eventPropArr","isArray","length","__o_","prop","hasOwnProperty","isInArray","push","isString","__c_","propChanged","triggerStr","join","methods","mock","root","forEach","item","old","Array","prototype","slice","call","result","apply","arguments","RegExp","test","cprop","isFunction","__p_","substring","toUpperCase","watch","path","undefined","currentValue","defineProperty","value","onPropertyChanged","oldValue","nan","rootName","getRootName","i","len","handler","all","indexOf","obj","Object","toString","isNaN","split","add","__r_","set","size","OBJECTTYPE","ARRAYTYPE","getPath","tempPath","keys","getUpdatePath","data","dataToPath","key","type","_objToPath","_arrayToPath","index","needUpdate","diffResult","updatePath","keyA","keyB","includePath","pathA","pathB","next","substr","fixPath","mpPath","replace","Number","components","updateSelfComponents","isSelf","currentComponent","$r","options","store","omis","val","patch","component","__$updatePath_","setState","__$id_","state","__$updateSelfPath_","use","updateSelfPath","useSelf","props","shouldComponentUpdate","render","React","Component","getGlobal","Omis","version","global","Math","self","window"],"mappings":"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"}